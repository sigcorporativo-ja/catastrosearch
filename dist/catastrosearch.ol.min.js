!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports='<div class="m-control m-catastrosearch-container">\n    \x3c!-- TITLE --\x3e\n    <div class="title">Búsqueda catastral</div>\n\n    <input id="tab1" class="tabs" data-tab="referencia" type="radio" name="tabs-catastro" checked>\n    <label for="tab1">Referencia</label>\n\n    <input id="tab2" class="tabs" data-tab="pol_par" type="radio" name="tabs-catastro">\n    <label for="tab2">Polígono/Parcela</label>\n    <div class="tabs-border"></div>\n    \x3c!-- FORM --\x3e\n    <div id="content1" class="form catastro">\n        \x3c!-- Referencia Catastral --\x3e\n        <div class="reference">\n            <label>Referencia Catastral</label>\n            <input type="text" maxlength="20">\n        </div>\n    </div>\n    \x3c!-- FORM --\x3e\n    <div id="content2" class="form catastro">\n        \x3c!-- Provincia --\x3e\n        <div class="province">\n            <label>Provincia</label>\n            <select name="provincelist">\n                <option value="">Provincia...</option>\n                {{#each provincias}}\n                <option value="{{this}}">{{this}}</option>\n                {{/each}}\n            </select>\n        </div>\n        \x3c!-- Municipio --\x3e\n        <div class="municipality">\n            <label>Municipio</label>\n            <select name="municipalitylist">\n                <option value="">Municipio...</option>\n            </select>\n        </div>\n        \x3c!-- Poligono --\x3e\n        <div class="polygon">\n            <label>Polígono</label>\n            <input type="number">\n        </div>\n        \x3c!-- Parcela --\x3e\n        <div class="parcel">\n            <label>Parcela</label>\n            <input type="number">\n        </div>\n    </div>\n    \x3c!-- buttons --\x3e\n    <div class="button">\n        <button class="load" title="Buscar coordenada" disabled>\n            <i class="g-cartografia-posicion3"></i> Buscar</button>\n        <button class="clear" title="Limpiar coordenadas" disabled>\n            <i class="g-cartografia-check4"></i> Limpiar</button>\n    </div>\n</div>'},function(e,t,n){},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=a(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.r(t);var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(u,M.impl.Control);var t,n,r,a=c(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this)).layer_=new M.layer.Vector({name:"Catastro_Coordinates"},{displayInLayerSwitcher:!1}),e}return t=u,(n=[{key:"addTo",value:function(e,t){this.facadeMap_=e,this.element=t,e.addLayers(this.layer_),i(s(u.prototype),"addTo",this).call(this,e,t)}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}},{key:"addCoordToMap",value:function(e,t,n){var r=ol.proj.transform([e,t],n,this.facadeMap_.getProjection().code),o=new M.Feature(null,{geometry:{coordinates:r,type:"Point"}});return this.layer_.addFeatures(o),this.layer_}},{key:"centerLayer",value:function(){var e=this.layer_.getFeaturesExtent();M.utils.isNullOrEmpty(e)||this.facadeMap_.getMapImpl().getView().fit(e,{duration:500,minResolution:1})}},{key:"clearCoordinatesLayer",value:function(){this.layer_.clear()}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(),f=n(0),d=n.n(f);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===y(i)?i:String(i)),r)}var o,i}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var o=_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(i,M.Control);var t,n,r,o=b(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(p)&&M.exception("La implementación usada no puede crear controles CatastroSearchControl");var t=new p;return(e=o.call(this,t,"CatastroSearch")).inputsTabs_=null,e.selectedTab_="",e.inputParcel_=null,e.inputPolygon_=null,e.selectMunicipality_=null,e.selectProvince_=null,e.inputReference_=null,e.provincias_=["ALMERIA","CADIZ","CORDOBA","GRANADA","HUELVA","JAEN","MALAGA","SEVILLA"],e}return t=i,(n=[{key:"addEvents",value:function(e){var t=this;this.loadBtn_=e.querySelector(".button > button.load"),this.clearBtn_=e.querySelector(".button > button.clear"),this.selectProvince_=e.querySelector(".form div.province > select"),this.selectMunicipality_=e.querySelector(".form div.municipality > select"),this.inputParcel_=e.querySelector(".form div.parcel > input"),this.inputPolygon_=e.querySelector(".form div.polygon > input"),this.inputReference_=e.querySelector(".form div.reference > input"),this.inputsTabs_=e.querySelectorAll('input[name="tabs-catastro"]'),this.selectedTab_=e.querySelector('input[name="tabs-catastro"]:checked').dataset.tab,this.clearBtn_.addEventListener("click",(function(e){return t.clearInputs()})),this.loadBtn_.addEventListener("click",(function(e){return t.getRC()})),this.selectProvince_.addEventListener("change",(function(e){return t.changeProvince(e)})),this.selectMunicipality_.addEventListener("change",(function(e){return t.changeMunicipality(e)})),this.inputParcel_.addEventListener("input",(function(e){return t.checkButtons(e)})),this.inputPolygon_.addEventListener("input",(function(e){return t.checkButtons(e)})),this.inputReference_.addEventListener("input",(function(e){return t.checkButtons(e)})),this.inputsTabs_.forEach((function(e){e.addEventListener("change",(function(e){return t.changeTab(e)}))}))}},{key:"getRC",value:function(){"referencia"==this.selectedTab_?(this.rc_=this.inputReference_.value,this.rc_.length>14&&(this.rc_=this.rc_.slice(0,14)),this.getCoordinatesRC()):this.getRCFromPP()}},{key:"changeTab",value:function(e){var t=(e=e||window.event).target;this.selectedTab_=t.dataset.tab,this.checkButtons()}},{key:"createView",value:function(e){var t=this;return M.template.compileSync||(M.template.compileSync=function(e,t){var n,r={};M.utils.isUndefined(t)||(r=M.utils.extends(r,t.vars),n=t.parseToHtml);var o=Handlebars.compile(e)(r);return!1!==n?M.utils.stringToHtml(o):o}),new Promise((function(e,n){var r=M.template.compileSync(d.a,{vars:{provincias:t.provincias_}});t.addEvents(r),e(r)}))}},{key:"checkButtons",value:function(){"referencia"==this.selectedTab_?(this.clearBtn_.disabled=M.utils.isNullOrEmpty(this.inputReference_.value),this.loadBtn_.disabled=M.utils.isNullOrEmpty(this.inputReference_.value)):(this.clearBtn_.disabled=M.utils.isNullOrEmpty(this.selectProvince_.value)&&M.utils.isNullOrEmpty(this.selectMunicipality_.value)&&M.utils.isNullOrEmpty(this.inputPolygon_.value)&&M.utils.isNullOrEmpty(this.inputParcel_.value),this.loadBtn_.disabled=M.utils.isNullOrEmpty(this.selectProvince_.value)||M.utils.isNullOrEmpty(this.selectMunicipality_.value)||M.utils.isNullOrEmpty(this.inputPolygon_.value)||M.utils.isNullOrEmpty(this.inputParcel_.value))}},{key:"clearInputs",value:function(){"referencia"==this.selectedTab_?this.inputReference_.value="":(this.inputPolygon_.value="",this.inputParcel_.value="",this.selectProvince_.value="",this.selectMunicipality_.value=""),this.checkButtons(),this.getImpl().clearCoordinatesLayer()}},{key:"changeProvince",value:function(e){this.checkButtons(),this.getMunicipios()}},{key:"changeMunicipality",value:function(e){this.checkButtons()}},{key:"getMunicipios",value:function(){var e=this;"referencia"==this.selectedTab_&&(this.rc_=this.inputReference_.value),M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/ConsultaMunicipio",{Provincia:this.selectProvince_.value,Municipio:""},{jsonp:!0}).then((function(t){var n=(new DOMParser).parseFromString(t.text,"text/xml"),r=n.getElementsByTagName("error");if(e.selectMunicipality_.innerHTML=null,e.createMunicipalityOption("Municipio...",""),r.length)M.dialog.error("Error al consultar al catastro: "+r[0].childNodes[0].nodeValue);else for(var o=n.getElementsByTagName("nm"),i=0;i<o.length;i++){var a=o[i].childNodes[0].nodeValue;e.createMunicipalityOption(a,a)}}))}},{key:"createMunicipalityOption",value:function(e,t){var n=document.createElement("option");n.value=t,n.innerHTML=e,this.selectMunicipality_.appendChild(n)}},{key:"getCoordinatesRC",value:function(){var e=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC",{Provincia:"",Municipio:"",SRS:"EPSG:4326",RC:this.rc_},{jsonp:!0}).then((function(t){var n=(new DOMParser).parseFromString(t.text,"text/xml"),r=n.getElementsByTagName("des");if(r.length)M.dialog.error(r[0].childNodes[0].nodeValue);else{var o=parseFloat(n.getElementsByTagName("xcen")[0].childNodes[0].nodeValue),i=parseFloat(n.getElementsByTagName("ycen")[0].childNodes[0].nodeValue);e.getImpl().clearCoordinatesLayer(),e.getImpl().addCoordToMap(o,i,"EPSG:4326"),e.getImpl().centerLayer()}}))}},{key:"getRCFromPP",value:function(){var e=this;M.remote.get("http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejero.asmx/Consulta_DNPPP",{Provincia:this.selectProvince_.value,Municipio:this.selectMunicipality_.value,Poligono:this.inputPolygon_.value,Parcela:this.inputParcel_.value},{jsonp:!0}).then((function(t){var n=(new DOMParser).parseFromString(t.text,"text/xml"),r=n.getElementsByTagName("des");if(r.length)M.dialog.info(r[0].childNodes[0].nodeValue);else{var o=n.getElementsByTagName("pc1"),i=n.getElementsByTagName("pc2");e.rc_=o[0].childNodes[0].nodeValue+i[0].childNodes[0].nodeValue,e.getCoordinatesRC()}}))}},{key:"equals",value:function(e){return e instanceof i}}])&&v(t.prototype,n),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}();n(1);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===P(i)?i:String(i)),r)}var o,i}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return E(this,n)}}function E(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(i,M.Plugin);var t,n,r,o=S(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=e||{},(t=o.call(this,e)).map_=null,t.control_=null,t.panel_=null,t.params_={},M.utils.isNullOrEmpty(e.params)||(t.params_=e.params),t.options_={},M.utils.isNullOrEmpty(e.options)||(t.options_=e.options),t}return t=i,(n=[{key:"addTo",value:function(e){var t=this;this.map_=e,this.control_=new g,this.panel_=new M.ui.Panel("catastrosearch",{collapsible:!0,className:"m-catastrosearch",collapsedButtonClass:"g-cartografia-localizacion3",position:M.ui.position.TR,tooltip:"Búsqueda catastral"}),this.panel_.on(M.evt.ADDED_TO_MAP,(function(e){M.utils.enableTouchScroll(e)})),this.panel_.addControls(this.control_),this.map_.addPanels(this.panel_),this.control_.on(M.evt.ADDED_TO_MAP,(function(){t.fire(M.evt.ADDED_TO_MAP)}))}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.map_=null,this.control_=null,this.panel_=null,this.options_=null}},{key:"equals",value:function(e){return e instanceof i}}])&&O(t.prototype,n),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.CatastroSearch=j,window.M.control.CatastroSearchControl=g,window.M.impl.control.CatastroSearchControl=p}]);
//# sourceMappingURL=catastrosearch.ol.min.js.map